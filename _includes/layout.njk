<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="canonical" href="{{ site.url }}{{ page.url | url }}" />

  {% set pageTitle = title or 'Democratic Justice' %}
  {% set pageDescription = description or 'Proof. Not Spin.' %}

  <title>{{ pageTitle }}</title>
  <meta name="description" content="{{ pageDescription }}">
  <meta property="og:title" content="{{ pageTitle }}">
  <meta property="og:description" content="{{ pageDescription }}">
  {% set fallbackImage = site.url ~ site.defaultImage %}
  {% set resolvedOgImage = ogImage or fallbackImage %}
  {% set resolvedTwitterImage = twitterImage or fallbackImage %}
  <meta property="og:image" content="{{ resolvedOgImage }}">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ pageTitle }}">
  <meta name="twitter:description" content="{{ pageDescription }}">
  <meta name="twitter:image" content="{{ resolvedTwitterImage }}">

  <meta name="theme-color" content="#0F2742">

  <link rel="manifest" href="/manifest.webmanifest">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Oswald:wght@600;700&display=swap">
  <link rel="preload" as="font" href="https://fonts.gstatic.com/s/lato/v24/S6uyw4BMUTPHvxk.ttf" type="font/ttf" crossorigin>
  <link rel="preload" as="font" href="https://fonts.gstatic.com/s/lato/v24/S6u9w4BMUTPHh6UVew8.ttf" type="font/ttf" crossorigin>
  <link rel="preload" as="font" href="https://fonts.gstatic.com/s/oswald/v57/TK3_WkUHHAIjg75cFRf3bXL8LICs1y9ogUE.ttf" type="font/ttf" crossorigin>
  <link rel="preload" as="font" href="https://fonts.gstatic.com/s/oswald/v57/TK3_WkUHHAIjg75cFRf3bXL8LICs1xZogUE.ttf" type="font/ttf" crossorigin>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Oswald:wght@600;700&display=swap">

  <style id="critical-hero-styles">
    {% include "critical.css" %}
  </style>

  <!-- Root-relative assets (safe from any page depth and pathPrefix-aware) -->
  <link rel="icon" href="{{ '/images/three-dots-blue.svg' | url }}" type="image/svg+xml">
  <link rel="stylesheet" href="{{ '/style.css' | url }}">
  {% set hasPagefind = (pagefind is defined) and pagefind %}
  {% if hasPagefind %}
  <link rel="stylesheet" href="{{ '/pagefind/pagefind-ui.css' | url }}">
  {% endif %}

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Organization",
          "name": "Democratic Justice",
          "url": "https://democraticjustice.org",
          "logo": "https://democraticjustice.org/images/wordmark-blue-on-white.svg"
        },
        {
          "@type": "WebSite",
          "url": "https://democraticjustice.org",
          "name": "Democratic Justice",
          "potentialAction": {
            "@type": "SearchAction",
            "target": "https://democraticjustice.org/search?q={search_term_string}",
            "query-input": "required name=search_term_string"
          }
        }
      ]
    }
  </script>

</head>
<body>

  {% set currentUrl = page.url or '/' %}
  {% set navData = nav or {} %}
  {% set primaryNav = (navData.primary is defined and navData.primary) and navData.primary or [] %}
  {% set quickNav = (navData.quick is defined and navData.quick) and navData.quick or [] %}
  {% set footerNav = navData.footer or {} %}

  <a class="skip" href="#main">Skip to content</a>

  <nav class="nav" aria-label="Primary">
    <div class="align-container">
      <div class="nav-inner">
        <div class="logo-wrap">
          <a href="{{ '/' | url }}" aria-label="Democratic Justice home">
            <picture>
              <source media="(prefers-color-scheme: dark)" srcset="{{ '/images/wordmark-white-on-blue.svg' | url }}">
              <img class="wordmark"
                   src="{{ '/images/wordmark-blue-on-white.svg' | url }}"
                   alt="Democratic Justice">
            </picture>
          </a>
        </div>
        <button class="nav-toggle" type="button" aria-expanded="false" aria-label="Menu" aria-controls="primary-nav">
          <svg class="nav-toggle-icon" aria-hidden="true" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M3 6h18M3 12h18M3 18h18" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
        <ul class="nav-links" id="primary-nav">
          {% for item in primaryNav %}
          {% set liClass = '' %}
          {% if item.list_class %}{% set liClass = liClass ~ ' ' ~ item.list_class %}{% endif %}
          {% if item.submenu %}{% set liClass = liClass ~ ' has-submenu' %}{% endif %}
          {% set linkClasses = page.url | navLinkClasses(item) %}
          {% set isActive = page.url | navIsActive(item) %}
          {% set attributes = item.attributes or {} %}
          {% set href = item.url or '#' %}
          <li class="nav-item{{ liClass }}">
            <a href="{{ href | url }}"{% if linkClasses %} class="{{ linkClasses }}"{% endif %}{% if isActive %} aria-current="page"{% endif %}
              {% for attr, value in attributes %} {{ attr }}="{{ value }}"{% endfor %}>{{ item.label }}</a>
            {% if item.submenu %}
            <ul class="nav-submenu">
              {% for subitem in item.submenu %}
              {% set subHref = subitem.url or '#' %}
              <li><a href="{{ subHref | url }}">{{ subitem.label }}</a></li>
              {% endfor %}
            </ul>
            {% endif %}
          </li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </nav>

  <main id="main">
    {{ content | safe }}
  </main>

  {% if site.mobileNavBreakpoint %}
    {% include "bottom-nav.html" %}
  {% endif %}

  <footer class="footer">
    <div class="align-container">
      <div class="footer-top">
        {% image "/images/wordmark-white-on-blue.svg", "Democratic Justice", {
          class: "footer-logo",
          widths: [200, 400],
          sizes: "200px"
        } %}
      </div>
      <div class="footer-grid">
        <div class="footer-mission">
          <p><strong>Proof. Not Spin.</strong></p>
          <p>A 100% volunteer-run project. We do not solicit or accept financial contributions. We do not endorse candidates.</p>
          <p><a href="mailto:setho@democraticjustice.org">Submit Proof Confidentially</a></p>
          <p>&copy; {{ now | date('%Y') }} Democratic Justice. All rights reserved.</p>
        </div>
        <nav class="footer-nav" aria-label="Footer navigation">
          {% if footerNav.groups %}
          {% for group in footerNav.groups %}
          <div class="footer-nav__group">
            <h3 class="footer-nav__heading">{{ group.heading }}</h3>
            {% if group.links %}
            <ul class="footer-nav__list">
              {% for link in group.links %}
              {% set linkHref = link.url or '#' %}
              {% set linkAttributes = link.attributes or {} %}
              {% set linkClasses = page.url | navLinkClasses(link) %}
              {% set linkActive = page.url | navIsActive(link) %}
              <li>
                <a href="{{ linkHref | url }}"{% if linkClasses %} class="{{ linkClasses }}"{% endif %}{% if linkActive %} aria-current="page"{% endif %}
                  {% for attr, value in linkAttributes %} {{ attr }}="{{ value }}"{% endfor %}>{{ link.label }}</a>
              </li>
              {% endfor %}
            </ul>
            {% endif %}
          </div>
          {% endfor %}
          {% endif %}
        </nav>
      </div>
      <a href="{{ '/' | url }}" aria-label="Democratic Justice home">
        {% image "/images/three-dots-white.svg", "", {
          class: "mark xl",
          widths: [32, 64],
          sizes: "32px",
          ariaHidden: true,
          style: "position:absolute; bottom: var(--gap); right: 20px; opacity: 0.5;"
        } %}
      </a>
    </div>
  </footer>

  <script defer src="/ga-consent.js"></script>
  {% if hasPagefind %}
  <script defer src="{{ '/pagefind/pagefind.js' | url }}"></script>
  <script defer src="{{ '/pagefind/pagefind-ui.js' | url }}"></script>
  {% endif %}
  <!-- Defer so it doesn't block rendering -->
  <script defer src="{{ '/bundle.js' | url }}"></script>

  {%- if env.CLOUDFLARE_ANALYTICS_TOKEN -%}
  <!-- Cloudflare Web Analytics -->
  <script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"token": "{{ env.CLOUDFLARE_ANALYTICS_TOKEN }}"}'></script>
  {%- endif -%}

  {%- if env.MICROSOFT_CLARITY_PROJECT_ID -%}
  <script type="text/javascript">
    window.democraticJustice = window.democraticJustice || {};

    window.democraticJustice.loadClarity = window.democraticJustice.loadClarity || function loadClarity() {
      if (window.democraticJustice.clarityLoaded) {
        return;
      }

      window.democraticJustice.clarityLoaded = true;

      var defaultSettings = {
        mask: true,
        maskText: true,
        maskImages: true
      };
      var customSettings = window.democraticJustice.claritySettings;
      if (!customSettings || typeof customSettings !== "object") {
        customSettings = {};
      }
      var combinedSettings = {};

      for (var key in defaultSettings) {
        if (Object.prototype.hasOwnProperty.call(defaultSettings, key)) {
          combinedSettings[key] = defaultSettings[key];
        }
      }

      for (var customKey in customSettings) {
        if (Object.prototype.hasOwnProperty.call(customSettings, customKey)) {
          combinedSettings[customKey] = customSettings[customKey];
        }
      }

      window.claritySettings = combinedSettings;

      (function (c, l, a, r, i, t, y) {
        c[a] = c[a] || function () {
          (c[a].q = c[a].q || []).push(arguments);
        };
        t = l.createElement(r);
        t.async = 1;
        t.type = "text/javascript";
        t.src = "https://www.clarity.ms/tag/" + i;

        var scriptAttributes = window.democraticJustice.clarityScriptAttrs;
        if (!scriptAttributes || typeof scriptAttributes !== "object") {
          scriptAttributes = {};
        }
        for (var attr in scriptAttributes) {
          if (Object.prototype.hasOwnProperty.call(scriptAttributes, attr)) {
            t.setAttribute(attr, scriptAttributes[attr]);
          }
        }

        y = l.getElementsByTagName(r)[0];
        y.parentNode.insertBefore(t, y);
      })(window, document, "clarity", "script", "{{ env.MICROSOFT_CLARITY_PROJECT_ID }}");
    };
  </script>
  {%- endif -%}

</body>
</html>
